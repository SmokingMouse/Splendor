# 功能规格: Splendor 人机对战

**功能分支**: `001-splendor-ai-match`  
**创建日期**: 2026-01-18  
**状态**: Draft  
**输入**: 用户描述: "实现或完善现有的 Splendor 的环境，并具备基本的交互能力（AI / 人类）间的对战；"

## 用户场景与测试 *(必填)*

### 用户故事 1 - 开始并完成一局人机对战 (优先级: P1)

作为玩家，我希望能启动一局与 AI 的对战并顺利完成整局流程，以便验证环境可用且对战体验完整。

**优先级原因**: 这是最核心的可交付能力，决定环境是否可用。

**独立测试**: 通过创建对局、执行完整回合、直至判定胜负来验证。

**验收场景**:

1. **Given** 我进入对战入口并选择开始对局，**When** 对局初始化完成，**Then** 系统进入可行动状态并显示当前局面
2. **Given** 对局进行中，**When** 达到胜利条件，**Then** 系统宣布胜负并结束对局

---

### 用户故事 2 - 在对局中执行合法行动并获得反馈 (优先级: P2)

作为玩家，我希望系统能引导我完成合法行动并拒绝非法行动，以便避免规则误用。

**优先级原因**: 没有清晰的合法/非法反馈，交互就不可用。

**独立测试**: 在对局中尝试合法行动与非法行动，系统给出明确反馈。

**验收场景**:

1. **Given** 轮到我行动，**When** 我提交合法行动，**Then** 行动被接受且局面更新

---

### 用户故事 3 - 使用 Web 界面进行对战 (优先级: P3)

作为玩家，我希望通过 Web 界面完成对局的开始、行动与结束查看，以便更直观地进行对战。

**优先级原因**: Web 入口提升可用性，便于演示与验证交互体验。

**独立测试**: 使用 Web 页面完成一局对战并查看胜负结果。

**验收场景**:

1. **Given** 我在 Web 界面发起对局，**When** 对局开始并完成，**Then** 页面展示完整的对局过程与胜负结果

---

### 边界情况

- 当玩家提交非法行动时系统如何提示与处理？
- 当对局无法继续（例如可行动作集为空）时如何处理？
- 当对局已结束仍尝试行动时系统如何处理？

## 需求 *(必填)*

### 功能需求

- **FR-001**: 系统必须支持创建并完成一局 Splendor 人机对战
- **FR-002**: 系统必须明确支持 Splendor 基础版规则
- **FR-003**: 系统必须在玩家轮次中给出可行动作的引导或提示
- **FR-004**: 系统必须拒绝非法行动并给出明确原因
- **FR-005**: 系统必须在对局结束时输出胜负与关键结算信息
- **FR-006**: 系统必须支持接入由训练产出的 AI 对手配置作为对战对手
- **FR-007**: 系统必须提供 Web 界面的人机对战基本交互方式

### 需求验收要点

- **FR-001**: 能从创建对局到完整结束并输出胜负结果
-- **FR-002**: 对局中的行动与结算符合基础版规则
- **FR-003**: 玩家轮次可获得可行动作的提示或引导
- **FR-004**: 非法行动被拒绝且反馈原因清晰
- **FR-005**: 结束时展示胜负与关键结算信息
-- **FR-006**: 可接入外部训练产生的 AI 配置并生效
-- **FR-007**: Web 交互覆盖从开始到结束的完整对战流程

### 关键实体 *(涉及数据时填写)*

- **对局**: 当前玩家、回合顺序、局面状态、胜负结果
- **玩家**: 玩家类型（人类/AI）、资源、卡牌与贵族状态
- **行动**: 行动类型、目标、合法性与结果
- **规则集**: 规则版本与可用行动集合定义

## 假设与依赖

- 对局为一对一人机对战，不包含多人或 AI vs AI 的对战模式
- 对战无需账号登录即可开始
- 规则范围为基础版，不包含扩展规则
- 依赖: 现有 Splendor 环境可进行基础对局初始化与回合推进
- AI 对手配置由用户训练后提供，系统仅负责接入与对战

## 成功标准 *(必填)*

### 可量化结果

- **SC-001**: 90% 的测试对局能够从开始到结束无阻塞完成
- **SC-002**: 合法行动提交后，局面更新在 2 秒内完成且玩家能够继续操作
- **SC-003**: 在 10 次非法行动测试中，系统 100% 给出明确的拒绝原因
- **SC-004**: 80% 的新用户在 10 分钟内完成第一局对战并理解胜负结果
